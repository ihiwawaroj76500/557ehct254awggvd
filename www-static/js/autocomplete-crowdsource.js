var CrowdSource_AC=function(){"use strict";var u=this;u.listCount=0,u.rtime=new Date,u.timeout=!1,u.delta=500,u.data={},u.init=function(t){u.params=t;var e=u.params.modal?u.params.modal.querySelector("#"+u.params.inputID):document.getElementById(u.params.inputID);e.parentNode.appendChild(u.buildElement("ul",{id:"list"+u.params.inputID,class:"acList"})),e.addEventListener("keyup",u.inputKeyUp,!1)},u.getAutocompleteData=function(){if($j.ajax({url:u.params.ajaxUrl,type:"GET",async:!1,data:{term:$j("#"+u.params.inputID).val()},success:function(t){u.data=t}}),"string"==typeof u.data){for(var t=u.data,e=0,a=(t=t.split(",")).length;e<a;e++)t[e]=t[e].replace(/\[|\]|"*/g,"");u.data=t}},u.timeoutData=function(){new Date-u.rtime<u.delta?setTimeout(u.timeoutData,u.delta):(u.getAutocompleteData(),u.timeout=!1,u.renderList())},u.inputKeyUp=function(t){t.preventDefault();var e=document.getElementById(u.params.inputID).value,a=u.params.inputID,n=t.keyCode?t.keyCode:t.charCode;13!=n&&27!=n&&37!=n&&38!=n&&39!=n&&40!=n&&0<e.length&&!/[-!$%^&*()_+|~=`\\#{}\[\]:";'<>?,.\/]/g.test(e)?(u.listCount=0,u.rtime=new Date,!1===u.timeout&&(u.timeout=!0,setTimeout(u.timeoutData(),u.delta))):27!=n&&""!=e||(document.getElementById("list"+a).innerHTML="")},u.buildElement=function(t,e){var a,n=document.createElement(t);for(a in e)n.setAttribute(a,e[a]);return n},u.renderList=function(){var t=u.params.inputID,e=document.getElementById("list"+t),a=u.data,n=0,i="";if(1<a.length||"object"==typeof a){e.innerHTML=i;for(var r,l=0,m=a.length;l<m;l++){n<u.params.listRows&&(r=u.params.listTpl,i+=r="object"==typeof a[l]?(r=(r=(r=(r=r.replace(/\[\[itemVal\]\]/,a[l].name)).replace(/\[\[itemId\]\]/,a[l].id)).replace(/\[\[voteVal\]\]/,a[l].vote)).replace(/\[\[itemThumb\]\]/,a[l].thumb)).replace(/\[\[matchVal\]\]/,a[l].name+"|"+a[l].id):r.replace(/\[\[itemVal\]\]/,a[l]),n++)}e.innerHTML+=i}else e.innerHTML=""}};